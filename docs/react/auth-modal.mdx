---
sidebar_position: 3
---

# EthosAuthModal

Complete authentication modal with wallet and social login support.

## Overview

`EthosAuthModal` is the main component for authentication. It provides a beautiful, animated modal that handles:

- Wallet selection and connection
- Passkey/WebAuthn authentication (Face ID, Touch ID, Windows Hello)
- Social authentication (Discord, Twitter, Farcaster, Telegram, GitHub)
- Error handling and user feedback
- Recent login history
- Responsive design for all screen sizes

## Basic Usage

```tsx
import { useState } from 'react';
import { EthosAuthModal } from '@thebbz/siwe-ethos-react';
import '@thebbz/siwe-ethos-react/styles.css';

function App() {
  const [isOpen, setIsOpen] = useState(false);

  const handleSuccess = (result) => {
    console.log('User:', result.user.name);
    console.log('Score:', result.user.ethosScore);
    console.log('Auth Method:', result.user.authMethod);
    setIsOpen(false);
  };

  return (
    <>
      <button onClick={() => setIsOpen(true)}>Sign In</button>

      <EthosAuthModal
        isOpen={isOpen}
        onClose={() => setIsOpen(false)}
        onSuccess={handleSuccess}
      />
    </>
  );
}
```

## Props

| Prop | Type | Required | Default | Description |
|------|------|----------|---------|-------------|
| `isOpen` | `boolean` | Yes | - | Controls modal visibility |
| `onClose` | `() => void` | Yes | - | Called when modal should close |
| `onSuccess` | `(result: EthosAuthResult) => void` | Yes | - | Called on successful authentication |
| `baseUrl` | `string` | No | `undefined` | Custom auth server URL |
| `showProviders` | `string[]` | No | All providers | Filter which providers to show |
| `showPasskey` | `boolean` | No | `false` | Enable passkey/WebAuthn authentication |
| `telegramBotUsername` | `string` | No | `undefined` | Telegram bot username for widget login |
| `termsUrl` | `string` | No | Ethos terms | Custom terms of service URL |
| `privacyUrl` | `string` | No | Ethos privacy | Custom privacy policy URL |

## Authentication Result

The `onSuccess` callback receives an `AuthResult`:

```typescript
interface AuthResult {
  accessToken: string;
  tokenType: 'Bearer';
  expiresIn: number;
  user: {
    sub: string;
    name: string;
    picture: string | null;
    ethosProfileId: number;
    ethosUsername: string | null;
    ethosScore: number;
    ethosStatus: string;
    ethosAttestations: string[];
    authMethod: 'wallet' | 'discord' | 'twitter' | 'farcaster' | 'telegram' | 'github' | 'passkey';
    walletAddress?: string;
    socialProvider?: string;
    socialId?: string;
    profileUrl?: string;
  };
  refreshToken?: string;
}
```

## Examples

### With Custom Server

```tsx
<EthosAuthModal
  isOpen={isOpen}
  onClose={onClose}
  onSuccess={onSuccess}
  baseUrl="https://your-server.com"
/>
```

### Filter Providers

Show only wallet authentication:

```tsx
<EthosAuthModal
  isOpen={isOpen}
  onClose={onClose}
  onSuccess={onSuccess}
  showProviders={['wallet']}
/>
```

Show only social providers:

```tsx
<EthosAuthModal
  isOpen={isOpen}
  onClose={onClose}
  onSuccess={onSuccess}
  showProviders={['farcaster', 'discord', 'twitter']}
/>
```

### Enable Passkeys

```tsx
<EthosAuthModal
  isOpen={isOpen}
  onClose={onClose}
  onSuccess={onSuccess}
  showPasskey={true}
/>
```

### With Telegram Widget

```tsx
<EthosAuthModal
  isOpen={isOpen}
  onClose={onClose}
  onSuccess={onSuccess}
  telegramBotUsername="YourBotUsername"
/>
```

### Custom Legal Links

```tsx
<EthosAuthModal
  isOpen={isOpen}
  onClose={onClose}
  onSuccess={onSuccess}
  termsUrl="https://yoursite.com/terms"
  privacyUrl="https://yoursite.com/privacy"
/>
```

### Complete Example

```tsx
import { useState } from 'react';
import { EthosAuthModal } from '@thebbz/siwe-ethos-react';
import type { AuthResult } from '@thebbz/siwe-ethos';

function AuthExample() {
  const [isOpen, setIsOpen] = useState(false);
  const [user, setUser] = useState<AuthResult['user'] | null>(null);

  const handleSuccess = (result: AuthResult) => {
    setUser(result.user);
    localStorage.setItem('ethos_token', result.accessToken);
    setIsOpen(false);

    console.log('Authenticated!');
    console.log('Display Name:', result.user.name);
    console.log('Score:', result.user.ethosScore);
    console.log('Auth Method:', result.user.authMethod);
  };

  const handleSignOut = () => {
    setUser(null);
    localStorage.removeItem('ethos_token');
  };

  return (
    <div>
      {user ? (
        <div>
          <img src={user.picture || ''} alt={user.name || 'User'} />
          <p>{user.name || user.ethosUsername}</p>
          <p>Score: {user.ethosScore}</p>
          <button onClick={handleSignOut}>Sign Out</button>
        </div>
      ) : (
        <button onClick={() => setIsOpen(true)}>Sign In with Ethos</button>
      )}

      <EthosAuthModal
        isOpen={isOpen}
        onClose={() => setIsOpen(false)}
        onSuccess={handleSuccess}
      />
    </div>
  );
}
```

## Modal Behavior

### Opening
- Fades in with backdrop
- Focuses on first interactive element
- Prevents body scroll
- Traps keyboard focus

### Closing
- Click backdrop
- Press Escape key
- Click close button
- Call `onClose()` prop

### Navigation
- Back button to return to provider selection
- Smooth transitions between views
- Loading states during authentication

## Views

The modal has several internal views:

1. **Main Select** - Choose between wallet, passkey, and social authentication
2. **Wallet Select** - Choose which wallet to connect
3. **Passkey View** - Sign in or register with passkey (Face ID, Touch ID, etc.)
4. **Social Select** - Choose social provider
5. **Telegram Widget** - Embedded Telegram login widget
6. **Connecting** - Loading state during authentication
7. **Success** - Shows user profile after successful auth
8. **Error** - Displays error messages

## Error Handling

The modal handles errors automatically:

```tsx
// Errors are displayed in the modal
// No additional error handling needed
<EthosAuthModal
  isOpen={isOpen}
  onClose={onClose}
  onSuccess={onSuccess}
/>
```

Common errors shown:
- No Ethos profile found
- User rejected signature
- Network errors
- Wallet not found

## Accessibility

The modal is fully accessible:

- ARIA labels and roles
- Keyboard navigation (Tab, Escape, Arrow keys)
- Screen reader support
- Focus management
- Color contrast compliance

## Performance

- Lazy loads provider-specific code
- Optimized bundle size
- Smooth animations with CSS transitions
- Minimal re-renders

## Next Steps

- [Passkey Authentication](/docs/react/passkey) - Learn about passkey/WebAuthn
- [Styling](/docs/react/styling) - Customize the modal appearance
- [SignInButton](/docs/react/sign-in-button) - Use the sign-in button
- [Hooks](/docs/react/hooks) - Manage auth state
